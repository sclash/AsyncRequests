# Async Requests

Python library to handle asynchronous http requests, built on top of the [requests](https://requests.readthedocs.io/en/latest/) library 

- [Installation](#installation)
- [Usage](#usage)

## Installation

```bash
pip install async-requests
```

## Usage

The library provide support for asynchronous http request, using the consumer-producer pattern.

Instantiate the class `AsyncHTTP` specifying a list of urls, (you can specify `N_PRODUCERS` and `N_CONSUMERS`: default values are `50` for both)

```python
from AysncRequests import AsyncHTPP

# default N_PRODUCERS and N_CONSUMERS to 50 

r = AsyncHTTP(
    url = ['https://github.com', 'https://google.com']
) 


# specify number of producers and consumers

r = AsyncHTTP(
    url = ['https://github.com', 'https://google.com'],
    N_PRODUCERS = 10,
    N_CONSUMERS = 10
)
```

To get the responses you can either call the generic `async_request` method explicitly specifying the http request type by passing to the `request_type` argument a `RequestType` Enum (`GET`, `POST`, `PUT`, `PATCH`, `DELETE`),
or you can use the `async_get`, `async_post`, `async_delete`,`async_put`, `async_patch` method without having to spepcify the request type.

```python
from RequestsType import RequestType
a.async_request(
    request_type=RequestType.GET,
)

a.async_get()

```

All methods support additional arguments such as `headers` as per the usual requests module

For the additional paramaters refer to the requests module documentation [Requests docs](https://requests.readthedocs.io/en/latest/)

```python
from RequestsType import RequestType

# Specify the RequestType

a.async_request(
    request_type=RequestType.GET,
    haeders = headers 
)

# Using async_get

a.async_get(headers = headers )
```

All methods support the use callback functions, to be used by the consumers on the `request.Response` object generated by the producers, as they become available in the `asyncio.Queue`

```python
headers = {'user-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36'}

def example_callaback(response: request.Response):
    return response.status_code 


a.async_request(
    request_type=RequestType.GET,
    callback = example_callback,
    headers = headers
)

a.async_get(
            headers = headers 
            callback = example_callback
)

```

The results will be stored in a list object, where you'll find either the `requests.Response` objects, or the output of the `callback` function 

```python 
a.response
```

Check the `test.py` script for an example.